<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Partial Least Squares Regression via SVD (Internal) — SVD.pls • snazzieR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Partial Least Squares Regression via SVD (Internal) — SVD.pls"><meta name="description" content='This function is called internally by pls.regression and is not intended
to be used directly. Use pls.regression(..., calc.method = "SVD") instead.
Performs Partial Least Squares (PLS) regression using the Singular Value Decomposition (SVD)
of the cross-covariance matrix. This method estimates the latent components by identifying directions
in the predictor and response spaces that maximize their covariance, using the leading singular vectors
of the matrix \(R = X^\top Y\).'><meta property="og:description" content='This function is called internally by pls.regression and is not intended
to be used directly. Use pls.regression(..., calc.method = "SVD") instead.
Performs Partial Least Squares (PLS) regression using the Singular Value Decomposition (SVD)
of the cross-covariance matrix. This method estimates the latent components by identifying directions
in the predictor and response spaces that maximize their covariance, using the leading singular vectors
of the matrix \(R = X^\top Y\).'></head><body><p>








  custom.css

  

  </p>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">snazzieR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/pls-overview.html">PLS Overview</a></li>
    <li><a class="dropdown-item" href="../articles/pls-nipals.html">NIPALS Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/pls-svd.html">SVD Algorithm</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Partial Least Squares Regression via SVD (Internal)</h1>

      <div class="d-none name"><code>SVD.pls.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is called internally by <code><a href="pls.regression.html">pls.regression</a></code> and is not intended
to be used directly. Use <code>pls.regression(..., calc.method = "SVD")</code> instead.</p>
<p>Performs Partial Least Squares (PLS) regression using the Singular Value Decomposition (SVD)
of the cross-covariance matrix. This method estimates the latent components by identifying directions
in the predictor and response spaces that maximize their covariance, using the leading singular vectors
of the matrix \(R = X^\top Y\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SVD.pls</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, n.components <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numeric matrix or data frame of predictors (X). Should have dimensions n × p.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric matrix or data frame of response variables (Y). Should have dimensions n × q.</p></dd>


<dt id="arg-n-components">n.components<a class="anchor" aria-label="anchor" href="#arg-n-components"></a></dt>
<dd><p>Integer specifying the number of PLS components to extract. If NULL, defaults to <code>qr(x)$rank</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><dl><dt>model.type</dt>
<dd><p>Character string indicating the model type ("PLS Regression").</p></dd>

  <dt>T</dt>
<dd><p>Matrix of predictor scores (n × H).</p></dd>

  <dt>U</dt>
<dd><p>Matrix of response scores (n × H).</p></dd>

  <dt>W</dt>
<dd><p>Matrix of predictor weights (p × H).</p></dd>

  <dt>C</dt>
<dd><p>Matrix of normalized response weights (q × H).</p></dd>

  <dt>P_loadings</dt>
<dd><p>Matrix of predictor loadings (p × H).</p></dd>

  <dt>Q_loadings</dt>
<dd><p>Matrix of response loadings (q × H).</p></dd>

  <dt>B_vector</dt>
<dd><p>Vector of scalar regression weights (length H).</p></dd>

  <dt>coefficients</dt>
<dd><p>Matrix of final regression coefficients in the original scale (p × q).</p></dd>

  <dt>intercept</dt>
<dd><p>Vector of intercepts (length q). All zeros due to centering.</p></dd>

  <dt>X_explained</dt>
<dd><p>Percent of total X variance explained by each component.</p></dd>

  <dt>Y_explained</dt>
<dd><p>Percent of total Y variance explained by each component.</p></dd>

  <dt>X_cum_explained</dt>
<dd><p>Cumulative X variance explained.</p></dd>

  <dt>Y_cum_explained</dt>
<dd><p>Cumulative Y variance explained.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The algorithm begins by z-scoring both <code>x</code> and <code>y</code> (centering and scaling to unit variance).
The initial residual matrices are set to the scaled values: <code>E = X_scaled</code>, <code>F = Y_scaled</code>.</p>
<p>For each component h = 1, ..., H:</p><ol><li><p>Compute the cross-covariance matrix \(R = E^\top F\).</p></li>
<li><p>Perform SVD on \(R = U D V^\top\).</p></li>
<li><p>Extract the first singular vectors: \(w = U[,1]\), \(q = V[,1]\).</p></li>
<li><p>Compute scores: \(t = E w\) (normalized), \(u = F q\).</p></li>
<li><p>Compute loadings: \(p = E^\top t\), regression scalar \(b = t^\top u\).</p></li>
<li><p>Deflate residuals: \(E \gets E - t p^\top\), \(F \gets F - b t q^\top\).</p></li>
</ol><p>After all components are extracted, a post-processing step removes components with zero regression
weight. The scaled regression coefficients are computed using the Moore–Penrose pseudoinverse of the
loading matrix \(P\), and then rescaled to the original variable units.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Abdi, H., &amp; Williams, L. J. (2013). Partial least squares methods: Partial least squares correlation and partial least square regression. <em>Methods in Molecular Biology (Clifton, N.J.)</em>, 930, 549–579. <a href="https://doi.org/10.1007/978-1-62703-059-5_23" class="external-link">doi:10.1007/978-1-62703-059-5_23</a></p>
<p>de Jong, S. (1993). SIMPLS: An alternative approach to partial least squares regression. <em>Chemometrics and Intelligent Laboratory Systems</em>, 18(3), 251–263. <a href="https://doi.org/10.1016/0169-7439%2893%2985002-X" class="external-link">doi:10.1016/0169-7439(93)85002-X</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="pls.regression.html">pls.regression</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, n.components <span class="op">=</span> <span class="fl">3</span>, calc.method <span class="op">=</span> <span class="st">"SVD"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">$</span><span class="va">coefficients</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aidan J. Wagner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  
</body></html>

